### RP5-Scrapper

Код расположен в [репозиторие](https://github.com/Fr0stFree/Scrapper-RP5).  Скрипт предназначен для загрузки геоданных с сайта [RP5](https://rp5.ru).

**<span style="color:red">Внимание!</span> Для запуска скрипта необходимо наличие установленного [ChromeDriver](https://chromedriver.chromium.org/) и зависимостей из файла `./requirements.txt`**

#### Запуск скрипта:

```bash
python ./app/main.py 2023-01-15 2023-02-10
```
_где 2023-01-15 2023-02-10 - диапазон дат для интересующих данных_

#### Алгоритм загрузки:

* скрипт на вход получает диапазон дат, за который необходимо найти данные;
* по пути` ./app/src/stations.py` расположен файл со станциями:

```python
class Station(NamedTuple):
  id: str
  name: str
  latitude: float
  longitude: float
  url: str
  
Station('23103', 'Khodovarikha', 68.933089, 53.758690, 'https://rp5.ru/Архив_погоды_в_Ходоварихе')
Station('23112', 'Varandey', 68.824039, 58.068760, 'https://rp5.ru/Архив_погоды_в_Варандее')
...
```

* скрипт запускает [ChromeWebdriver](https://chromedriver.chromium.org/), управляемый библиотекой [selenium](https://selenium-python.readthedocs.io/)
* скрипт парсит веб-страницы, которые закреплены за каждой из станции и согласно сценарию, отправляет запрос на
  загрузку архива с необходимыми данными.
* после загрузки архив распаковывается, данные валидируются и конвертируются в формат <code>.geojson</code>
* для каждой из станций сценарий повторяется, а данные объеденяются в **[FeatureCollection](https://ru.wikipedia.org/wiki/GeoJSON)**. в едином <code>result.geojson</code>.
* результат дампится в директорию `./app/src/data/`

---

*Образец получаемых данных:*

```json
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          33.098581,
          68.915173
        ]
      },
      "properties": {
        "DATETIME": "16.05.2023 12:00",
        "T": 19.9,
        "Po": 753.7,
        "P": 758.2,
        "Pa": -0.1,
        "U": 33,
        "DD": "Ветер, дующий с юго-запада",
        "Ff": 6,
        "ff10": 10.0,
        "ff3": 12.0,
        "N": "70 – 80%.",
        "WW": " ",
        "W1": null,
        "W2": null,
        "Tn": null,
        "Tx": null,
        "Cl": "Кучевые средние или мощные или вместе с кучевыми разорванными, или с кучевыми плоскими, или со слоисто-кучевыми, либо без них; основания всех этих облаков расположены на одном уровне.",
        "Nh": "20–30%.",
        "H": "600-1000",
        "Cm": "Клочья (часто чечевицеобразные) высококучевых просвечивающих, непрерывно изменяющихся; расположены на одном или более уровнях.",
        "Ch": "Перистые когтевидные или нитевидные или первые и вторые, распространяющиеся по небу и в целом обычно уплотняющиеся.",
        "VV": 50.0,
        "Td": 2.9,
        "RRR": null,
        "tR": null,
        "E": null,
        "Tg": null,
        "E'": null,
        "sss": null
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          33.098581,
          68.915173
        ]
      },
      "properties": {
        "DATETIME": "16.05.2023 09:00",
        "T": 17.3,
        "Po": 753.8,
        "P": 758.3,
        "Pa": -0.6,
        "U": 41,
        "DD": "Ветер, дующий с юго-юго-запада",
        "Ff": 5,
        "ff10": 8.0,
        "ff3": 8.0,
        "N": "20–30%.",
        "WW": "Состояние неба в общем не изменилось. ",
        "W1": "Ливень (ливни).",
        "W2": "Облака покрывали более половины неба в течение одной части соответствующего периода и половину или менее в течение другой части периода.",
        "Tn": 9.9,
        "Tx": null,
        "Cl": "Слоисто-кучевых, слоистых, кучевых или кучево-дождевых облаков нет.",
        "Nh": "10%  или менее, но не 0",
        "H": "2500 или более, или облаков нет.",
        "Cm": "Клочья (часто чечевицеобразные) высококучевых просвечивающих, непрерывно изменяющихся; расположены на одном или более уровнях.",
        "Ch": "Перисто-кучевые одни или перисто-кучевые, сопровождаемые перистыми или перисто-слоистыми, либо те и другие, но перисто-кучевые преобладают среди них.",
        "VV": 50.0,
        "Td": 3.9,
        "RRR": "Следы осадков",
        "tR": 12.0,
        "E": null,
        "Tg": null,
        "E'": "Слежавшийся или мокрый снег (со льдом или без него), покрывающий менее половины поверхности почвы.",
        "sss": "Снежный покров не постоянный."
      }
    }
  ]
}
```
